{
  "id": "aspect-form",
  "formKey": "aspect-form",
  "title": {
    "en": "aspect-form"
  },
  "description": {},
  "customModule": "",
  "typeRef": "emodel/type@ecos-aspect",
  "width": "",
  "system": false,
  "i18n": {},
  "definition": {
    "components": [
      {
        "scrollableContent": true,
        "key": "panel3",
        "type": "panel",
        "components": [
          {
            "label": {
              "ru": "Panel"
            },
            "key": "Base",
            "title": {
              "ru": "Основные",
              "en": "Base"
            },
            "refreshOn": [],
            "optionalWhenDisabled": false,
            "type": "panel",
            "input": false
          },
          {
            "label": {
              "ru": "Columns"
            },
            "key": "columns",
            "columns": [
              {
                "components": [
                  {
                    "label": {
                      "ru": "Название",
                      "en": "Name"
                    },
                    "key": "name",
                    "inputMasks": [
                      {
                        "label": "",
                        "mask": ""
                      }
                    ],
                    "defaultValue": "",
                    "refreshOn": [],
                    "optionalWhenDisabled": false,
                    "type": "textfield",
                    "input": true
                  },
                  {
                    "label": {
                      "ru": "Префикс",
                      "en": "Prefix"
                    },
                    "key": "prefix",
                    "validate": {
                      "required": true
                    },
                    "inputMasks": [
                      {
                        "label": "",
                        "mask": ""
                      }
                    ],
                    "defaultValue": "",
                    "refreshOn": [],
                    "optionalWhenDisabled": false,
                    "unique": true,
                    "type": "textfield",
                    "input": true
                  }
                ],
                "type": "column",
                "input": false,
                "key": "column",
                "index": 0,
                "classes": "2"
              },
              {
                "index": 1,
                "type": "column",
                "input": false,
                "key": "column",
                "components": [
                  {
                    "label": {
                      "ru": "Форма",
                      "en": "Form"
                    },
                    "key": "aspectFormRef",
                    "modalTitle": "",
                    "journalId": "ecos-forms",
                    "queryData": "",
                    "refreshOn": [],
                    "optionalWhenDisabled": false,
                    "type": "selectJournal",
                    "input": true
                  }
                ]
              }
            ],
            "oneColumnInViewMode": false,
            "type": "columns",
            "input": false
          },
          {
            "title": {
              "ru": "Атрибуты",
              "en": "Attributes"
            },
            "scrollableContent": true,
            "collapsible": true,
            "key": "panel10",
            "type": "panel",
            "input": false,
            "components": [
              {
                "label": {
                  "en": "Attributes",
                  "ru": "Атрибуты"
                },
                "key": "aspectAttributes",
                "hideLabel": true,
                "multiple": true,
                "validate": {
                  "minLength": "",
                  "maxLength": ""
                },
                "disableAddingRemovingRows": false,
                "addAnother": "",
                "addAnotherPosition": "bottom",
                "removePlacement": "col",
                "defaultOpen": false,
                "layoutFixed": false,
                "enableRowGroups": false,
                "rowGroups": [
                  {
                    "label": "",
                    "numberOfRows": ""
                  }
                ],
                "reorder": true,
                "defaultValue": [
                  {
                    "id2": "",
                    "id": "",
                    "name2": {},
                    "name": {},
                    "submit3": false,
                    "submit4": false,
                    "submit": false,
                    "submit6": false,
                    "submit7": false,
                    "submit8": false,
                    "container": {
                      "submit7": false
                    },
                    "submit9": false,
                    "multiple": false,
                    "ecosSelect": "",
                    "select": "",
                    "multiple2": false,
                    "mandatory": false,
                    "type": "TEXT",
                    "id3": "",
                    "name3": {
                      "ru": "",
                      "en": ""
                    },
                    "type3": "TEXT",
                    "multiple3": false,
                    "mandatory3": false,
                    "submit5": false
                  }
                ],
                "refreshOn": [],
                "optionalWhenDisabled": false,
                "type": "datagrid",
                "input": true,
                "components": [
                  {
                    "label": {
                      "ru": "Список атрибутов",
                      "en": "Attributes list"
                    },
                    "key": "columns7",
                    "columns": [
                      {
                        "components": [
                          {
                            "label": {
                              "ru": "Id",
                              "en": "Id"
                            },
                            "key": "id",
                            "validate": {
                              "pattern": "(^$|[_a-zA-Z][_\\w-.:]*)"
                            },
                            "inputMasks": [
                              {
                                "label": "",
                                "mask": ""
                              }
                            ],
                            "defaultValue": "",
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "type": "textfield",
                            "input": true
                          },
                          {
                            "label": {
                              "ru": "Имя",
                              "en": "Name"
                            },
                            "key": "name",
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "type": "mlText",
                            "input": true,
                            "row": "0-1"
                          }
                        ],
                        "type": "column",
                        "input": false,
                        "key": "column",
                        "index": 0,
                        "md": 3
                      },
                      {
                        "index": 1,
                        "type": "column",
                        "input": false,
                        "key": "column",
                        "components": [
                          {
                            "label": {
                              "ru": "Тип            ",
                              "en": "Type"
                            },
                            "key": "type",
                            "dataSrc": "values",
                            "data": {
                              "values": [
                                {
                                  "label": "Text",
                                  "value": "TEXT"
                                },
                                {
                                  "label": "ML Text",
                                  "value": "MLTEXT"
                                },
                                {
                                  "label": "Person",
                                  "value": "PERSON"
                                },
                                {
                                  "label": "Group",
                                  "value": "AUTHORITY_GROUP"
                                },
                                {
                                  "label": "Authority",
                                  "value": "AUTHORITY"
                                },
                                {
                                  "label": "Association",
                                  "value": "ASSOC"
                                },
                                {
                                  "label": "Number",
                                  "value": "NUMBER"
                                },
                                {
                                  "label": "Boolean",
                                  "value": "BOOLEAN"
                                },
                                {
                                  "label": "Date",
                                  "value": "DATE"
                                },
                                {
                                  "label": "DateTime",
                                  "value": "DATETIME"
                                },
                                {
                                  "label": "Content",
                                  "value": "CONTENT"
                                },
                                {
                                  "label": "JSON",
                                  "value": "JSON"
                                },
                                {
                                  "label": "Binary",
                                  "value": "BINARY"
                                }
                              ],
                              "headers": [
                                {
                                  "key": "",
                                  "value": ""
                                }
                              ]
                            },
                            "defaultValue": "TEXT",
                            "optionalWhenDisabled": false,
                            "type": "ecosSelect",
                            "input": true,
                            "row": "0-2"
                          },
                          {
                            "label": {
                              "ru": "Настроить",
                              "en": "Setup"
                            },
                            "key": "submit9",
                            "action": "custom",
                            "state": "",
                            "showValidations": false,
                            "custom": "var currentRow = row;\nvar config = row.config || {}; \nvar formData = config;\n\nCiteck.EcosFormUtils.getFormById('uiserv/form@att-type-' + row.type + '-form', {\n    definition: 'definition?json'\n}).then(function(formConfig) {\n    \n    var inputs = Citeck.EcosFormUtils.getFormInputs(formConfig.definition);\n\n    Citeck.Dialogs.showFormDialog({\n        title: 'Attribute type config',\n        showDefaultButtons: true,\n        formDefinition: formConfig.definition,\n        formData: formData,\n        onSubmit: submission => {\n            var data = submission.data || {};\n            var configData = {};\n            for (var i in inputs) {\n                var att = inputs[i].attribute;\n                configData[att] = data[att];\n            }\n            currentRow.config = configData;\n        }\n    })\n    \n});",
                            "block": true,
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "logic": [
                              {
                                "name": "check form",
                                "trigger": {
                                  "type": "javascript",
                                  "javascript": "result = Citeck.EcosFormUtils.getFormById('uiserv/form@att-type-' + row.type + '-form', {\n    definition: 'definition?json'\n}).then(config => {\n  const isEmptyConfig = _.isEmpty(_.get(config, 'definition'));\n  \n  instance.showElement(!isEmptyConfig);\n  \n  return config;\n});\n"
                                },
                                "actions": [
                                  {
                                    "name": "test",
                                    "type": "property",
                                    "property": {
                                      "label": "Container Custom Class",
                                      "value": "customClass",
                                      "type": "string"
                                    },
                                    "text": "test-test-test"
                                  }
                                ]
                              }
                            ],
                            "type": "button",
                            "input": true,
                            "row": "0-3"
                          },
                          {
                            "label": {
                              "ru": "Конфигурация",
                              "en": "Config"
                            },
                            "key": "config",
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "properties": {
                              "dataType": "json"
                            },
                            "type": "hidden",
                            "input": true
                          }
                        ],
                        "md": 3
                      },
                      {
                        "index": 2,
                        "type": "column",
                        "input": false,
                        "key": "column",
                        "components": [
                          {
                            "label": {
                              "ru": "Множественный",
                              "en": "Multiple"
                            },
                            "key": "multiple",
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "type": "checkbox",
                            "input": true,
                            "row": "0-5"
                          },
                          {
                            "label": {
                              "ru": "Обязательный",
                              "en": "Mandatory"
                            },
                            "key": "mandatory",
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "type": "checkbox",
                            "input": true,
                            "row": "0-5"
                          }
                        ],
                        "md": 3
                      },
                      {
                        "index": 3,
                        "type": "column",
                        "input": false,
                        "key": "column",
                        "components": [
                          {
                            "label": {
                              "en": "Permissions"
                            },
                            "hideLabel": true,
                            "action": "custom",
                            "state": "",
                            "showValidations": false,
                            "custom": "\nvar mapToSingleLang = function (value) {\n  return {\n    id: value.id,\n    name: Citeck.helpers.getMLValue(value.name)\n  };\n};\n\nvar typeRef = 'emodel/type@' + data.moduleId;\nvar customProps = {\n  roles: (data.modelRoles || []).map(mapToSingleLang),\n  statuses: (data.modelStatuses || []).map(mapToSingleLang),\n  attributeName: Citeck.helpers.getMLValue(row.name)\n};\n\nvar typeDispName = Citeck.helpers.getMLValue(data.name);\nif (typeDispName) {\n\tcustomProps.typeDispName = typeDispName;\n}\n\nCiteck.TypePermissionsService.editTypeAttPermissions(\n  typeRef, \n  row.id, \n  customProps\n)",
                            "leftIcon": "icon-decision-tables",
                            "block": true,
                            "key": "submit5",
                            "customConditional": "show = _.get(data, 'ecosEdition.isEnterprise', false)",
                            "type": "button",
                            "input": true,
                            "row": "0-4"
                          },
                          {
                            "label": {
                              "en": " "
                            },
                            "key": "submit9",
                            "action": "custom",
                            "state": "",
                            "showValidations": false,
                            "custom": "var currentRow = row;\nvar computed = row.computed || {}; \nvar computedType = computed.type || 'NONE';\nvar formData = {\n    type: computedType,\n    storingType: computed.storingType || 'NONE'\n};\nformData[computedType + '_config'] = computed.config || {};\n\n\nCiteck.EcosFormUtils.getFormById('uiserv/form@computed-attribute-form', {\n    definition: 'definition?json'\n}).then(function(formConfig) {\n    const lang = form && form.i18next && form.i18next.options ? form.i18next.options.lng : 'en';\n    let modalTitle = '';\n    if(lang === 'ru') { \n      modalTitle = 'Вычисляемые атрибуты'; \n    }\n    if(lang === 'en') {\n      modalTitle = 'Computed attribute';\n    }\n    \n    Citeck.Dialogs.showFormDialog({\n        title: modalTitle,\n        showDefaultButtons: true,\n        formDefinition: formConfig.definition,\n        formData: formData,\n        onSubmit: submission => {\n            var data = submission.data || {};\n\n            currentRow.computed = {\n                type: data.type,\n                storingType: data.storingType,\n                config: data[data.type + '_config']\n            }\n        }\n    })\n    \n});",
                            "removeIndents": true,
                            "leftIcon": "icon-items",
                            "block": true,
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "type": "button",
                            "input": true
                          },
                          {
                            "label": {
                              "ru": "Вычисляемый атрибут",
                              "en": "Computed attribute"
                            },
                            "key": "computed",
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "properties": {
                              "dataType": "json"
                            },
                            "type": "hidden",
                            "input": true
                          }
                        ],
                        "md": 3
                      }
                    ],
                    "oneColumnInViewMode": false,
                    "type": "columns",
                    "input": false,
                    "row": "0-0"
                  }
                ],
                "tab": 3
              }
            ],
            "collapsed": false,
            "tab": 1
          },
          {
            "label": {
              "ru": "Panel"
            },
            "key": "panel11",
            "title": {
              "ru": "Системные атрибуты",
              "en": "Sysytem atributes"
            },
            "collapsible": true,
            "collapsed": false,
            "scrollableContent": true,
            "refreshOn": [],
            "optionalWhenDisabled": false,
            "type": "panel",
            "input": false,
            "components": [
              {
                "label": {
                  "en": "System attributes",
                  "ru": "Системные атрибуты"
                },
                "key": "aspectSystemAttributes",
                "hideLabel": true,
                "multiple": true,
                "validate": {
                  "minLength": "",
                  "maxLength": ""
                },
                "disableAddingRemovingRows": false,
                "addAnother": "",
                "addAnotherPosition": "bottom",
                "removePlacement": "col",
                "defaultOpen": false,
                "layoutFixed": false,
                "enableRowGroups": false,
                "rowGroups": [
                  {
                    "label": "",
                    "numberOfRows": ""
                  }
                ],
                "reorder": true,
                "defaultValue": [
                  {
                    "id2": "",
                    "id": "",
                    "name2": {},
                    "name": {},
                    "submit3": false,
                    "submit4": false,
                    "type": "TEXT",
                    "submit": false,
                    "submit6": false,
                    "submit7": false,
                    "submit8": false,
                    "container": {
                      "submit7": false
                    },
                    "submit9": false,
                    "multiple": false,
                    "ecosSelect": "",
                    "select": "",
                    "multiple2": false,
                    "mandatory": false,
                    "type2": "TEXT",
                    "mandatory2": false,
                    "id4": "",
                    "name4": {
                      "ru": "",
                      "en": ""
                    },
                    "type4": "TEXT",
                    "submit10": false,
                    "multiple4": false,
                    "mandatory4": false
                  }
                ],
                "refreshOn": [],
                "optionalWhenDisabled": false,
                "type": "datagrid",
                "input": true,
                "components": [
                  {
                    "label": {
                      "ru": "Список атрибутов",
                      "en": "Attributes list"
                    },
                    "key": "columns8",
                    "columns": [
                      {
                        "components": [
                          {
                            "label": {
                              "ru": "Id",
                              "en": "Id"
                            },
                            "key": "id4",
                            "validate": {
                              "pattern": "(^$|[_a-zA-Z][_\\w-.:]*)"
                            },
                            "type": "textfield",
                            "input": true
                          },
                          {
                            "label": {
                              "ru": "Имя",
                              "en": "Name"
                            },
                            "key": "name4",
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "type": "mlText",
                            "input": true,
                            "row": "0-1"
                          }
                        ],
                        "type": "column",
                        "input": false,
                        "key": "column",
                        "index": 0,
                        "md": 3
                      },
                      {
                        "index": 1,
                        "type": "column",
                        "input": false,
                        "key": "column",
                        "components": [
                          {
                            "label": {
                              "ru": "Тип            ",
                              "en": "Type"
                            },
                            "key": "type4",
                            "dataSrc": "values",
                            "data": {
                              "values": [
                                {
                                  "label": "Text",
                                  "value": "TEXT"
                                },
                                {
                                  "label": "ML Text",
                                  "value": "MLTEXT"
                                },
                                {
                                  "label": "Person",
                                  "value": "PERSON"
                                },
                                {
                                  "label": "Group",
                                  "value": "AUTHORITY_GROUP"
                                },
                                {
                                  "label": "Authority",
                                  "value": "AUTHORITY"
                                },
                                {
                                  "label": "Association",
                                  "value": "ASSOC"
                                },
                                {
                                  "label": "Number",
                                  "value": "NUMBER"
                                },
                                {
                                  "label": "Boolean",
                                  "value": "BOOLEAN"
                                },
                                {
                                  "label": "Date",
                                  "value": "DATE"
                                },
                                {
                                  "label": "DateTime",
                                  "value": "DATETIME"
                                },
                                {
                                  "label": "Content",
                                  "value": "CONTENT"
                                },
                                {
                                  "label": "JSON",
                                  "value": "JSON"
                                },
                                {
                                  "label": "Binary",
                                  "value": "BINARY"
                                }
                              ]
                            },
                            "defaultValue": "TEXT",
                            "optionalWhenDisabled": false,
                            "type": "ecosSelect",
                            "input": true,
                            "row": "0-2"
                          },
                          {
                            "label": {
                              "ru": "Настроить",
                              "en": "Setup"
                            },
                            "key": "submit10",
                            "action": "custom",
                            "state": "",
                            "showValidations": false,
                            "custom": "var currentRow = row;\nvar config = row.config || {}; \nvar formData = config;\n\nCiteck.EcosFormUtils.getFormById('uiserv/form@att-type-' + row.type + '-form', {\n    definition: 'definition?json'\n}).then(function(formConfig) {\n    \n    var inputs = Citeck.EcosFormUtils.getFormInputs(formConfig.definition);\n\n    Citeck.Dialogs.showFormDialog({\n        title: 'Attribute type config',\n        showDefaultButtons: true,\n        formDefinition: formConfig.definition,\n        formData: formData,\n        onSubmit: submission => {\n            var data = submission.data || {};\n            var configData = {};\n            for (var i in inputs) {\n                var att = inputs[i].attribute;\n                configData[att] = data[att];\n            }\n            currentRow.config = configData;\n        }\n    })\n    \n});",
                            "block": true,
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "logic": [
                              {
                                "name": "check form",
                                "trigger": {
                                  "type": "javascript",
                                  "javascript": "result = Citeck.EcosFormUtils.getFormById('uiserv/form@att-type-' + row.type + '-form', {\n    definition: 'definition?json'\n}).then(config => {\n  const isEmptyConfig = _.isEmpty(_.get(config, 'definition'));\n  \n  instance.showElement(!isEmptyConfig);\n  \n  return config;\n});\n"
                                },
                                "actions": [
                                  {
                                    "name": "test",
                                    "type": "property",
                                    "property": {
                                      "label": "Container Custom Class",
                                      "value": "customClass",
                                      "type": "string"
                                    },
                                    "text": "test-test-test"
                                  }
                                ]
                              }
                            ],
                            "type": "button",
                            "input": true,
                            "row": "0-3"
                          },
                          {
                            "label": {
                              "ru": "Конфигурация",
                              "en": "Config"
                            },
                            "key": "config4",
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "properties": {
                              "dataType": "json"
                            },
                            "type": "hidden",
                            "input": true
                          }
                        ],
                        "md": 3
                      },
                      {
                        "index": 2,
                        "type": "column",
                        "input": false,
                        "key": "column",
                        "components": [
                          {
                            "label": {
                              "ru": "Множественный",
                              "en": "Multiple"
                            },
                            "key": "multiple4",
                            "type": "checkbox",
                            "input": true,
                            "row": "0-5"
                          },
                          {
                            "label": {
                              "ru": "Обязательный",
                              "en": "Mandatory"
                            },
                            "key": "mandatory4",
                            "type": "checkbox",
                            "input": true,
                            "row": "0-5"
                          }
                        ],
                        "md": 3
                      },
                      {
                        "index": 3,
                        "type": "column",
                        "input": false,
                        "key": "column",
                        "components": [
                          {
                            "label": {
                              "en": "Permissions"
                            },
                            "hideLabel": true,
                            "action": "custom",
                            "state": "",
                            "showValidations": false,
                            "custom": "\nvar mapToSingleLang = function (value) {\n  return {\n    id: value.id,\n    name: Citeck.helpers.getMLValue(value.name)\n  };\n};\n\nvar typeRef = 'emodel/type@' + data.moduleId;\nvar customProps = {\n  roles: (data.modelRoles || []).map(mapToSingleLang),\n  statuses: (data.modelStatuses || []).map(mapToSingleLang),\n  attributeName: Citeck.helpers.getMLValue(row.name)\n};\n\nvar typeDispName = Citeck.helpers.getMLValue(data.name);\nif (typeDispName) {\n\tcustomProps.typeDispName = typeDispName;\n}\n\nCiteck.TypePermissionsService.editTypeAttPermissions(\n  typeRef, \n  row.id, \n  customProps\n)",
                            "leftIcon": "icon-decision-tables",
                            "block": true,
                            "key": "submit10",
                            "customConditional": "show = _.get(data, 'ecosEdition.isEnterprise', false)",
                            "type": "button",
                            "input": true,
                            "row": "0-4"
                          },
                          {
                            "label": {
                              "ru": "Вычисляемый атрибут",
                              "en": "Computed attribute"
                            },
                            "key": "computed4",
                            "refreshOn": [],
                            "optionalWhenDisabled": false,
                            "properties": {
                              "dataType": "json"
                            },
                            "type": "hidden",
                            "input": true
                          }
                        ],
                        "md": 3
                      }
                    ],
                    "oneColumnInViewMode": false,
                    "type": "columns",
                    "input": false,
                    "row": "0-0"
                  }
                ],
                "tab": 3
              }
            ],
            "tab": 1
          }
        ],
        "input": false
      },
      {
        "columns": [
          {
            "type": "column",
            "md": 3,
            "index": 0,
            "components": [
              {
                "label": {
                  "ru": "Отменить",
                  "en": "Cancel"
                },
                "key": "submit2",
                "action": "event",
                "state": "",
                "showValidations": false,
                "event": "cancel",
                "block": true,
                "refreshOn": [],
                "optionalWhenDisabled": false,
                "type": "button",
                "input": true
              }
            ],
            "key": "column",
            "conditional": {
              "show": null,
              "when": null
            },
            "input": false
          },
          {
            "type": "column",
            "index": 1,
            "components": [],
            "key": "column",
            "conditional": {
              "show": null,
              "when": null
            },
            "input": false,
            "md": 3
          },
          {
            "components": [],
            "type": "column",
            "md": 3,
            "key": "column",
            "index": 2,
            "conditional": {
              "show": null,
              "when": null
            },
            "input": false
          },
          {
            "md": 3,
            "type": "column",
            "input": false,
            "key": "column",
            "index": 3,
            "components": [
              {
                "label": {
                  "ru": "Сохранить",
                  "en": "Submit"
                },
                "key": "submit",
                "state": "",
                "theme": "primary",
                "block": true,
                "disableOnInvalid": true,
                "refreshOn": [],
                "optionalWhenDisabled": false,
                "type": "button",
                "input": true
              }
            ]
          }
        ],
        "key": "columns2",
        "type": "columns",
        "input": false
      }
    ],
    "display": "form",
    "formId": "aspect-form"
  },
  "attributes": {},
  "notExists": false
}
